<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body></body>

  <script>
    // 创建一个Set来存储所有的副作用函数
    const EffectSet = new Set();

    // 原始数据
    var obj = { text: "Hello World" };

    // 数据代理
    let proxyData = new Proxy(obj, {
      get(target, key) {
        EffectSet.add(effect);
        return target[key];
      },
      set(target, key, value) {
        target[key] = value;
        EffectSet.forEach((fn) => fn());
        return true;
      },
    });
    // 副作用函数
    function effect() {
      document.body.innerText = proxyData.text;
    }
    // 执行副作用函数
    effect();

    // 修改数据
    setTimeout(() => {
      proxyData.text = "Hello Vue3";
    }, 1000);
  </script>
</html>
